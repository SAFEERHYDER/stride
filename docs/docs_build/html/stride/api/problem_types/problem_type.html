

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Problem type &mdash; Stride</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Acoustic" href="acoustic.html" />
    <link rel="prev" title="Problem Types" href="problem_types_index.html" />
    <link href="../../../_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> Stride
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../download.html">Download</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api_index.html">Stride API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../runner.html">Runner</a></li>
<li class="toctree-l2"><a class="reference internal" href="../problem_definition/problem_definition_index.html">Problem definition</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="problem_types_index.html">Problem Types</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Problem type</a></li>
<li class="toctree-l3"><a class="reference internal" href="acoustic.html">Acoustic</a></li>
<li class="toctree-l3"><a class="reference internal" href="operators.html">Operators</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../optimisation/optimisation_index.html">Optimisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plotting/plotting_index.html">Plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../utils/utils_index.html">Utils</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../mosaic/api/api_index.html">Mosaic API Reference</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Stride</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../api_index.html">Stride API Reference</a> &raquo;</li>
        
          <li><a href="problem_types_index.html">Problem Types</a> &raquo;</li>
        
      <li>Problem type</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../_sources/stride/api/problem_types/problem_type.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="problem-type">
<h1>Problem type<a class="headerlink" href="#problem-type" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="stride.problem_types.problem_type.ProblemTypeBase">
<em class="property">class </em><code class="sig-prename descclassname">stride.problem_types.problem_type.</code><code class="sig-name descname">ProblemTypeBase</code><a class="reference internal" href="../../../_modules/stride/problem_types/problem_type.html#ProblemTypeBase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#stride.problem_types.problem_type.ProblemTypeBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Problem types encode the physics of the forward and inverse problems that we want
to solve using Stride. In most cases, these physics will correspond to state and adjoint PDEs
describing problems of interest.</p>
<p>A problem type could have multiple implementations, depending on how the physics are solved
or the techniques that are used to solve them.</p>
<p>For example, the <code class="docutils literal notranslate"><span class="pre">acoustic</span></code> problem corresponds to the second-order isotropic acoustic
wave equation, which currently has one implementation using the Devito library. This implementation
is contained within the <code class="docutils literal notranslate"><span class="pre">acoustic/devito</span></code> folder.</p>
<p>Problem types inherit from this base class, and have to comply with a certain interface by
defining, at least, a series of methods.</p>
<p>To solve the state or forward problem:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">before_state</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">state</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">after_state</span></code></p></li>
</ul>
<p>and to solve the adjoint problem:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">before_adjoint</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">adjoint</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">after_adjoint</span></code></p></li>
</ul>
<p>If the problem type has to provide the gradient for a certain optimisation variable, the
class will also have to define a pair of methods per variable:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">set_grad_[variable_name]</span></code> will be called before the adjoint run to prepare the calculation of the gradient.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_grad_[variable_name]</span></code> will be called after the adjoint run to fill in the calculated gradients.</p></li>
</ul>
<p>in order for the gradients to be calculated.</p>
<dl class="py method">
<dt id="stride.problem_types.problem_type.ProblemTypeBase.adjoint">
<em class="property">abstract </em><code class="sig-name descname">adjoint</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wrt</span></em>, <em class="sig-param"><span class="n">adjoint_source</span></em>, <em class="sig-param"><span class="n">wavefield</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/stride/problem_types/problem_type.html#ProblemTypeBase.adjoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#stride.problem_types.problem_type.ProblemTypeBase.adjoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the adjoint problem.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wrt</strong> (<a class="reference internal" href="../optimisation/optimisation.html#stride.optimisation.optimisation.VariableList" title="stride.optimisation.optimisation.VariableList"><em>VariableList</em></a>) – List of variables for which the inverse problem is being solved.</p></li>
<li><p><strong>adjoint_source</strong> (<a class="reference internal" href="../problem_definition/data.html#stride.problem_definition.data.Traces" title="stride.problem_definition.data.Traces"><em>Traces</em></a>) – Adjoint source to use in the adjoint propagation.</p></li>
<li><p><strong>wavefield</strong> (<a class="reference internal" href="../problem_definition/data.html#stride.problem_definition.data.Data" title="stride.problem_definition.data.Data"><em>Data</em></a>) – Stored wavefield from the forward run, to use as needed.</p></li>
<li><p><strong>kwargs</strong> – Extra parameters to be used by the method.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="stride.problem_types.problem_type.ProblemTypeBase.after_adjoint">
<em class="property">abstract </em><code class="sig-name descname">after_adjoint</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wrt</span></em>, <em class="sig-param"><span class="n">adjoint_source</span></em>, <em class="sig-param"><span class="n">wavefield</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/stride/problem_types/problem_type.html#ProblemTypeBase.after_adjoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#stride.problem_types.problem_type.ProblemTypeBase.after_adjoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Clean up after the adjoint run and retrieve the time gradients (if needed).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wrt</strong> (<a class="reference internal" href="../optimisation/optimisation.html#stride.optimisation.optimisation.VariableList" title="stride.optimisation.optimisation.VariableList"><em>VariableList</em></a>) – List of variables for which the inverse problem is being solved.</p></li>
<li><p><strong>adjoint_source</strong> (<a class="reference internal" href="../problem_definition/data.html#stride.problem_definition.data.Traces" title="stride.problem_definition.data.Traces"><em>Traces</em></a>) – Adjoint source to use in the adjoint propagation.</p></li>
<li><p><strong>wavefield</strong> (<a class="reference internal" href="../problem_definition/data.html#stride.problem_definition.data.Data" title="stride.problem_definition.data.Data"><em>Data</em></a>) – Stored wavefield from the forward run, to use as needed.</p></li>
<li><p><strong>kwargs</strong> – Extra parameters to be used by the method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Updated variable list with gradients added to them.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="../optimisation/optimisation.html#stride.optimisation.optimisation.VariableList" title="stride.optimisation.optimisation.VariableList">VariableList</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="stride.problem_types.problem_type.ProblemTypeBase.after_state">
<em class="property">abstract </em><code class="sig-name descname">after_state</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">save_wavefield</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/stride/problem_types/problem_type.html#ProblemTypeBase.after_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#stride.problem_types.problem_type.ProblemTypeBase.after_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Clean up after the state run and retrieve the time traces.</p>
<p>If requested, also provide a saved wavefield.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_wavefield</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether or not the wavefield needs to be stored, defaults to False.</p></li>
<li><p><strong>kwargs</strong> – Extra parameters to be used by the method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Traces</em> – Time traces produced by the state run.</p></li>
<li><p><em>Data or None</em> – Wavefield produced by the state run, if any.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="stride.problem_types.problem_type.ProblemTypeBase.before_adjoint">
<em class="property">abstract </em><code class="sig-name descname">before_adjoint</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wrt</span></em>, <em class="sig-param"><span class="n">adjoint_source</span></em>, <em class="sig-param"><span class="n">wavefield</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/stride/problem_types/problem_type.html#ProblemTypeBase.before_adjoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#stride.problem_types.problem_type.ProblemTypeBase.before_adjoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare the problem type to run the adjoint problem.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wrt</strong> (<a class="reference internal" href="../optimisation/optimisation.html#stride.optimisation.optimisation.VariableList" title="stride.optimisation.optimisation.VariableList"><em>VariableList</em></a>) – List of variables for which the inverse problem is being solved.</p></li>
<li><p><strong>adjoint_source</strong> (<a class="reference internal" href="../problem_definition/data.html#stride.problem_definition.data.Traces" title="stride.problem_definition.data.Traces"><em>Traces</em></a>) – Adjoint source to use in the adjoint propagation.</p></li>
<li><p><strong>wavefield</strong> (<a class="reference internal" href="../problem_definition/data.html#stride.problem_definition.data.Data" title="stride.problem_definition.data.Data"><em>Data</em></a>) – Stored wavefield from the forward run, to use as needed.</p></li>
<li><p><strong>kwargs</strong> – Extra parameters to be used by the method.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="stride.problem_types.problem_type.ProblemTypeBase.before_state">
<em class="property">abstract </em><code class="sig-name descname">before_state</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">save_wavefield</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/stride/problem_types/problem_type.html#ProblemTypeBase.before_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#stride.problem_types.problem_type.ProblemTypeBase.before_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare the problem type to run the state or forward problem.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_wavefield</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether or not the wavefield needs to be stored, defaults to False.</p></li>
<li><p><strong>kwargs</strong> – Extra parameters to be used by the method.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="stride.problem_types.problem_type.ProblemTypeBase.get_grad">
<code class="sig-name descname">get_grad</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wrt</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/stride/problem_types/problem_type.html#ProblemTypeBase.get_grad"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#stride.problem_types.problem_type.ProblemTypeBase.get_grad" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve the gradients calculated wrt to the inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wrt</strong> (<a class="reference internal" href="../optimisation/optimisation.html#stride.optimisation.optimisation.VariableList" title="stride.optimisation.optimisation.VariableList"><em>VariableList</em></a>) – List of variable with respect to which the inversion is running.</p></li>
<li><p><strong>kwargs</strong> – Extra parameters to be used by the method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Updated variable list with gradients added to them.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="../optimisation/optimisation.html#stride.optimisation.optimisation.VariableList" title="stride.optimisation.optimisation.VariableList">VariableList</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="stride.problem_types.problem_type.ProblemTypeBase.set_grad">
<code class="sig-name descname">set_grad</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wrt</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/stride/problem_types/problem_type.html#ProblemTypeBase.set_grad"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#stride.problem_types.problem_type.ProblemTypeBase.set_grad" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare the problem type to calculate the gradients wrt the inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wrt</strong> (<a class="reference internal" href="../optimisation/optimisation.html#stride.optimisation.optimisation.VariableList" title="stride.optimisation.optimisation.VariableList"><em>VariableList</em></a>) – List of variable with respect to which the inversion is running.</p></li>
<li><p><strong>kwargs</strong> – Extra parameters to be used by the method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of update rules (if any) for the gradients of the problem type
with respect to the inputs</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="stride.problem_types.problem_type.ProblemTypeBase.set_problem">
<code class="sig-name descname">set_problem</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">problem</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/stride/problem_types/problem_type.html#ProblemTypeBase.set_problem"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#stride.problem_types.problem_type.ProblemTypeBase.set_problem" title="Permalink to this definition">¶</a></dt>
<dd><p>Set up the problem or sub-problem that needs to be run.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>problem</strong> (<a class="reference internal" href="../problem_definition/problem.html#stride.problem_definition.problem.SubProblem" title="stride.problem_definition.problem.SubProblem"><em>SubProblem</em></a><em> or </em><a class="reference internal" href="../problem_definition/problem.html#stride.problem_definition.problem.Problem" title="stride.problem_definition.problem.Problem"><em>Problem</em></a>) – Problem on which the physics will be executed</p></li>
<li><p><strong>kwargs</strong> – Extra parameters to be used by the method.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="stride.problem_types.problem_type.ProblemTypeBase.space_order">
<code class="sig-name descname">space_order</code><em class="property"> = -1</em><a class="headerlink" href="#stride.problem_types.problem_type.ProblemTypeBase.space_order" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="stride.problem_types.problem_type.ProblemTypeBase.state">
<em class="property">abstract </em><code class="sig-name descname">state</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/stride/problem_types/problem_type.html#ProblemTypeBase.state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#stride.problem_types.problem_type.ProblemTypeBase.state" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the state or forward problem.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> – Extra parameters to be used by the method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="stride.problem_types.problem_type.ProblemTypeBase.time_order">
<code class="sig-name descname">time_order</code><em class="property"> = -1</em><a class="headerlink" href="#stride.problem_types.problem_type.ProblemTypeBase.time_order" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="acoustic.html" class="btn btn-neutral float-right" title="Acoustic" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="problem_types_index.html" class="btn btn-neutral float-left" title="Problem Types" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright .

    </p>
  </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>